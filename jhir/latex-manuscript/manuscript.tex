%%%%%%%%%%%%%%%%%%%%%%% file template.tex %%%%%%%%%%%%%%%%%%%%%%%%%
%
% This is a general template file for the LaTeX package SVJour3
% for Springer journals.          Springer Heidelberg 2010/09/16
%
% Copy it to a new file with a new name and use it as the basis
% for your article. Delete % signs as needed.
%
% This template includes a few options for different layouts and
% content for various journals. Please consult a previous issue of
% your journal as needed.
%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%
% First comes an example EPS file -- just ignore it and
% proceed on the \documentclass line
% your LaTeX will extract the file if required
\begin{filecontents*}{example.eps}
%!PS-Adobe-3.0 EPSF-3.0
%%BoundingBox: 19 19 221 221
%%CreationDate: Mon Sep 29 1997
%%Creator: programmed by hand (JK)
%%EndComments
gsave
newpath
  20 20 moveto
  20 220 lineto
  220 220 lineto
  220 20 lineto
closepath
2 setlinewidth
gsave
  .4 setgray fill
grestore
stroke
grestore
\end{filecontents*}
%
\RequirePackage{fix-cm}
%
%\documentclass{svjour3}                     % onecolumn (standard format)
%\documentclass[smallcondensed]{svjour3}     % onecolumn (ditto)
\documentclass[smallextended]{svjour3}       % onecolumn (second format)
%\documentclass[twocolumn]{svjour3}          % twocolumn
%
\smartqed  % flush right qed marks, e.g. at end of proof
%
\usepackage{graphicx}
\usepackage[numbers,sort&compress]{natbib}
\usepackage{geometry}
\usepackage{pdflscape}
%
\usepackage{mathptmx}      % use Times fonts if available on your TeX system

\usepackage{rotating}
\usepackage{tabularx}
\usepackage{longtable,tabu}
\usepackage[flushleft]{threeparttable}
\usepackage{caption}
\captionsetup{justification=raggedright,singlelinecheck=off,labelfont=bf}
\usepackage{color, colortbl}
\definecolor{lightgraycol}{gray}{0.95}

% Insert the name of "your journal" with
\journalname{J Healthc Inform Res}
%
\begin{document}

\title{Identifying Effective Motivational Interviewing Sequences Using Automated Pattern Analysis
}

\author{Mehedi Hasan$^1$\and 
April Idalski Carcone$^2$\and 
Sylvie Naar$^3$\and 
Susan Eggly$^4$\and  
Gwen L. Alexander$^5$\and 
Kathryn E Brogan Hartlieb$^6$\and 
Alexander Kotov$^1$
}

\institute{Mehedi Hasan \at
              \email{mehedi@wayne.edu} 
           \and
           April Idalski Carcone \at
              \email{acarcone@med.wayne.edu} 
           \and
           Sylvie Naar \at
              \email{sylvie.naar@med.fsu.edu}
           \and
           Susan Eggly \at
              \email{egglys@karmanos.org} 
           \and
           Gwen L. Alexander \at
              \email{GALEXAN2@hfhs.org}
           \and
           Kathryn E Brogan Hartlieb \at
              \email{hartlieb@fiu.edu} 
           \and
           Alexander Kotov (corresponding author) \at
              Tel.: +1(313) 577-9307 \\
              \email{kotov@wayne.edu} 
           \and
           $^1$Department of Computer Science, College of Engineering, Wayne State University, Detroit, MI 48202\\
$^2$Division of Behavioral Sciences, Department of Family Medicine and Public Health Sciences, Wayne State University School of Medicine, Detroit, MI 48202\\
$^3$Director, Center for Translational Behavioral Research, Department of Behavioral Sciences and Social Medicine, Florida State University, FL 32306\\  
$^4$Department of Oncology, Wayne State University/Karmanos Cancer Institute, Detroit, MI 48201\\
$^5$Department of Public Health Sciences, Henry Ford Health System, Detroit, MI 48202\\
$^6$Department of Humanities, Health and Society, Wertheim College of Medicine, Florida International University, Miami, FL 33199    
}

\date{Received: 3 December 2018 /Revised: 16 April 2018}
% The correct dates will be entered by the editor


\maketitle

\begin{abstract}
Motivational Interviewing (MI) is an evidence-based strategy for communicating with patients about behavior change. Although there is strong empirical evidence linking ``MI-consistent'' counselor behaviors and patient motivational statements (i.e., ``change talk''), the specific counselor communication behaviors effective for eliciting patient change talk vary by treatment context and, thus, are a subject of ongoing research. A significant barrier to this research is the time and resource-intensive cognitive tasks, including the manual coding and sequential analysis of coded transcripts, that are an integral part of the qualitative analysis of patient-counselor communication. Data mining and machine learning techniques have the potential to significantly reduce this barrier by partially automating these cognitive tasks. In this paper, we evaluate the empirical effectiveness of the Hidden Markov Model, a probabilistic generative model for sequence data, for modeling sequences of behavior codes and closed frequent pattern mining, a method to identify frequently occurring sequential patterns of behavior codes in MI communication sequences to inform MI practice. We conducted experiments with 1,360 communication sequences from 37 transcribed audio recordings of weight loss counseling sessions with African-American adolescents with obesity and their caregivers. Transcripts had been previously annotated with patient-counselor behavior codes using a specialized codebook. Empirical results indicate that Hidden Markov Model and closed frequent pattern mining techniques can identify counselor communication strategies that are effective at eliciting patients' motivational statements to guide clinical practice.

\keywords{hidden markov model \and closed frequent pattern mining \and motivational interviewing \and pediatric obesity}
\end{abstract}

\section{Introduction}
\label{sec:intro}
Motivational Interviewing (MI) is an evidence-based strategy for communicating with patients about behavior change~\cite{miller2013motivational}. The theory underlying MI's clinical efficacy posits that behavior change is triggered by fostering an atmosphere of change, which is accomplished through the exercise of relational and technical skills~\cite{miller2013motivational}. The relational hypothesis suggests that counselors' use of accurate empathy, positive regard, and congruence create the ``spirit of MI'', an optimal therapeutic state to explore behavior change. MI's technical hypothesis~\cite{miller2009toward} states that counselors' use of communication techniques consistent with the MI framework (``MI-consistent'' or MICO; e.g., open-ended questions, reflections, advise with permission, affirmations, emphasize control, reframe, and support) will lead to patient ``change talk''. Change talk is patient statements during clinical encounters that express their internal desire, ability, reasons, need for, and/or commitment to behavior change. Previous studies~\cite{apodaca2009mechanisms} have shown that change talk expressed during treatment sessions consistently predicts behavior change with results persisting as long as 34 months post-intervention~\cite{walker2011influence}. In contrast, MI-inconsistent communication behaviors (MIIN; e.g., advising without permission, warning about behavioral consequences, and confronting) are hypothesized to lead to arguments against behavioral change and/or to maintain the status quo (referred to as counter change talk or sustain talk). Multiple studies have linked high rates of MICO to the expression of change talk and MIIN to sustain talk~\cite{magill2014technical}. These studies have relied on session-level behavior counts and correlational analyses, which ignore the temporal order of utterances in patient-counselor communication, thereby limiting researchers' ability to test MI's technical hypothesis. 

Sequential analysis is an analytic approach to examine temporally ordered sequences of events or observations~\cite{bakeman1997observing, bakeman2011sequential}. Moyers and Martin~\cite{moyers2006therapist} applied sequential analysis in a study of adults in treatment for alcohol abuse and found change talk was significantly more likely after MICO and sustain talk more likely after MIIN. A follow up study with the same population found change talk was more likely after two MICO behaviors, counselor questions about the positive and negative aspects of drinking and reflections of change talk, but these behaviors also led to sustain talk~\cite{moyers2009session}. Surprisingly, MIIN was unrelated to sustain talk, but decreased the likelihood of change talk. Gaume et al.~\cite{gaume2008counsellor} used sequential analysis to study communication patterns during brief motivational interviewing for hazardous alcohol consumption with young adults conscripted into military service. They found MICO led to both change talk and sustain talk but the MIIN-to-sustain talk pattern was not observed. A second study with the same population confirmed that MICO leads to significantly more change talk and sustain talk~\cite{gaume2010counselor}. In this sample, MIIN led to greater sustain talk, but was unrelated to change talk. Further analyses revealed that reflections were the only MICO behavior linked to increased change talk; reflections and other MICO behaviors, excluding questions, were related to increased sustain talk. Glynn and colleagues~\cite{glynn2014change} linked reflections of change talk to the elicitation of change talk and reflections of sustain talk to the elicitation of sustain talk among incarcerated adolescents with high rates of alcohol and marijuana use. In a study of adolescents engaged in weight loss treatment, Carcone et al.~\cite{carcone2013provider} used sequential analysis to identify three counselor behaviors likely to result in change talk: open-ended questions phrased to elicit change talk, reflections of change talk, and statements emphasizing decision-making autonomy. A parallel study of the adolescents' caregivers~\cite{jacques2016building} drew a similar conclusion, asking questions phrased to elicit change talk, reflections of change talk, and autonomy supportive statements were the counselor behaviors empirically linked to the elicitation of change talk. Across these studies, counselors' use of reflections was consistently linked to change talk; other MICO behaviors led to change talk in some contexts but not others suggesting a need for additional research to understand the contexts in which the various MICO strategies are effective. 

The sequential analysis procedure used in the above MI process studies~\cite{moyers2006therapist, catley2006adherence, thrasher2006motivational, mccambridge2011fidelity} is based on the first-order Markov Chain model~\cite{moyers2006therapist, moyers2009session, gaume2010counselor}. The Markov Chain model is a discrete-time stochastic process built on the assumption that the state of a system or condition changes over time and only depends on the previous event. Hence, Markov chain models have two main drawbacks. The first is their inability to preserve the long-range dependencies between observations in a sequence. However, in MI, an observed behavior can be influenced by any of the preceding behaviors. The second drawback is their inability to consider similarities between behavior codes and, consequently, their inability to identify multiple similar behaviors that lead to the same outcome. Thus, first-order Markov models may be insufficient to fully understand the associations between behaviors in patient-counselor communication sequences. Therefore, there is a need for more powerful computational methods, which consider clusters of similar behavior codes and long-term dependencies between behaviors, to identify causal relationships. The goal of the current research is to test the applicability of pattern data mining and machine-learning methods to identify effective patterns of patient-counselor communication.

Several prior works have reported the results of adopting machine learning methods, such as topic models~\cite{kotov2014towards, gaut2017content, imel2015computational, kotov2015interpretable, atkins2014scaling}, classification methods~\cite{hasan2016study, can2016sounds, perez2017predicting, perez2017understanding} and neural networks~\cite{hasan2016study, tanana2015recursive, tanana2016comparison} to the tasks of annotating MI transcripts and assessing intervention fidelity. Perez-Rosas et al.~\cite{perez2017predicting} developed a natural language processing system to evaluate counselor fidelity to the MI framework by observing counselor language during motivational interviews. Because MI fidelity is assessed in part by the ratio of counselor questions to reflection (a minimum goal is 1:1), their system employed a SVM classifier based on n-grams (contiguous sequences of words of a specified length), syntactic, and semantic features achieving nearly 90\% accuracy. In our own recent work, we evaluated the accuracy of state-of-the-art classification methods and deep neural networks in conjunction with the lexical, contextual, and semantic features for the task of automated annotation of MI transcripts using codebooks with varying numbers of behavior codes~\cite{hasan2016study}. The SVM model with the aforementioned features achieved 75\% accuracy for automated annotation of 17 behavior codes, which is comparable to human coders. In a follow up study~\cite{hasan2018predicting}, we applied Markov Models (MMs) and Recurrent Neural Networks (RNNs) to the classification of coded patient-counselor communication sequences into successful (sequences leading to patient change talk) and unsuccessful (sequences resulting in sustain talk). RNN achieved 87\% accuracy, 17\% greater than MMs (70\%) in predicting the success of motivational interviews. This paper represents the next phase in this line of research. We examine the efficacy of Hidden Markov Models (HMMs) and frequent pattern mining in identifying the counselor communication strategies antecedent to patient change talk.

HMMs are widely used for the analysis of sequence data due to their ability to model short-range dependencies between clusters of discrete observations in a sequence. The HMM associates each observation in a sequence with a ``hidden'' state, which corresponds to a distribution over all distinct observations in a sequence (i.e., probabilities associated with each observation, when HMM is in this hidden state), such that each ``hidden state'' corresponds to a different distribution. Sequences of observations are modeled as transitions between different hidden states and sampling observations from distributions corresponding to each hidden state. HMMs were originally proposed for speech recognition~\cite{rabiner1989tutorial}, in which the states were used to represent all English language sounds. In biomedical informatics, HMMs were employed for the diagnosis of diseases and biological sequence modeling~\cite{uuguz2007biomedical, amrhein2003client}. For example, a HMM-based classifier was applied Doppler ultrasound imaging data to extract features from from the images that were then used to distinguish healthy patients from those with heart disease~\cite{uuguz2007biomedical}. In another study, HMM was used to capture important
characteristics of protein families~\cite{amrhein2003client}. In the application of HMM to patient-counselor communication, hidden states, and the sets of related behavior codes associated with the hidden states, may correspond a patient’s underlying motivational state during a patient-counselor encounter. Although the MI literature has established patient change talk and commitment language (a special class of change talk where patients express their intentions, plans, and action steps toward behavior change~\cite{baldi1994hidden}) as the antecedents of patients' behavior change~\cite{apodaca2009mechanisms}, there is less clarity regarding which counselor communication strategies influence the articulation of change talk. Modeling successful and unsuccessful communication sequences during MI sessions with HMM can provide additional evidence to identify the counselor communication strategies that are likely to lead to patient change talk and commitment language. 

Frequent pattern mining~\cite{aggarwal2014frequent} is a class of data mining methods to identify sets of items (or observations, referred to as itemsets) which frequently appear together. Agrawal and Srikant~\cite{agrawal1994fast} first introduced frequent pattern mining with the Apriori algorithm, which they developed to identify patterns in customer purchases. Since its introduction, frequent pattern mining has been applied to several other domains, including health informatics~\cite{abdullah2008analysis, olukunle2002fast, bethel2006mining, wright2015use}, medical imaging~\cite{olukunle2002fast}, chemical and biological analysis~\cite{deshpande2005frequent, leach2007introduction, zhang2008discovering}, web mining~\cite{srivastava2000web}, and outlier analysis~\cite{aggarwal2015outlier}. No published research has yet examined the utility of frequent pattern mining for studying patient-counselor communication. A major challenge in applying frequent pattern mining methods to patient-counselor communication sequences is the large number of resulting patterns, which include redundant patterns. To address this problem, we utilized the closed frequent itemset mining method~\cite{pasquier1999discovering}, which produces fewer patterns in more compact form that are easier to interpret. In this study, we leveraged FPClose~\cite{grahne2005fast}, an efficient state-of-the-art closed frequent pattern mining method, to identify the counselor behaviors that frequently lead to patient change talk. FPClose is the best closed frequent itemset mining algorithm, which has shown highest performance in terms of running time and memory consumption.

In this paper, we focus on computational methods to facilitate the sequential analysis of MI transcripts to identify patterns of patient-counselor communication in successful and unsuccessful sequences in MI sessions. Analysis of these patterns will provide empirical support for the specific counselor communication strategies that are effective at eliciting patient change talk. This knowledge will inform MI theory by providing additional evidence to support MI's technical hypothesis. It will also inform clinical practice by facilitating the use of more effective and tailored counselor communication. This paper is the first empirical evaluation of the effectiveness of closed frequent pattern mining to analyze patient-counselor communication sequences during MI sessions. Bertholet et al.~\cite{bertholet2010change} used HMM to identify hidden states in a brief motivational intervention. Namely, they limited their HMM model to three hidden states which they characterized as ``towards change'', ``away from change'' and ``non-determined''. These states were then used as predictors in a bivariate regression model to predict drinking outcomes 12 months post-intervention. In the current study, we identified the optimal number of hidden states using HMM modeling of successful and unsuccessful sequences of patient-counselor communication. The goal of this study to evaluate the utility of using HMM and frequent pattern mining to better understand the specific counselor communication strategies leading to patient change talk and sustain talk during Motivational Interviewing sessions. These two approaches offer the following advantages over the first-order Markov chain based methods most typically used in MI research. First-order Markov chain models identify the likely transitions between individual behaviors. In contrast, HMM summarizes transitions between clusters of related behavior codes (i.e., hidden states) allowing the identification of clusters of behaviors antecedent to change talk in successful patient-counselor communications and sustain talk in unsuccessful patient-counselor communications. Frequent pattern mining can identify patterns involving long-range dependencies between patient and counselor behaviors. Accounting for such long-range dependencies is important, since human behaviors, such as patient-counselor communications during MI sessions, are informed by all the antecedent behaviors and not just the immediately preceding behavior.

\section{Materials and Methods}
\label{sec:materialsAndMethods}

\subsection{Dataset}
\label{subsec:dataset}
The data set for this study consists of 37 audio recorded transcripts from Motivational Interviewing (MI) sessions conducted with African American adolescents seeking weight loss. Each transcript represented a one-on-one interaction between the adolescent and the MI counselor followed by a one-on-one interaction between the caregiver and the MI counselor. These encounters had previously been annotated using the Minority Youth Sequential Code for Observing Process Exchanges (MYSCOPE)~\cite{carcone2013provider}. The MYSCOPE is an adaptation of the original MI-SCOPE~\cite{martin2005motivational}, a qualitative code scheme to characterize patient-counselor communication during MI treatment sessions. The MYSCOPE was informed by MI fidelity code schemes including the MI Treatment Integrity Scale (MITI)~\cite{moyers2005assessing}, the MI Skill Code (MISC)~\cite{apodaca2007motivational}, and Amrhein's conceptualization of change talk and commitment~\cite{amrhein2004does}. A primary coder used the MYSCOPE to annotate transcripts of all 37 sessions; a secondary coder coded 20\% ($n = 7$) of the sessions for inter-rater reliability which was good ($k = .696$). The experimental dataset consists of 7,192 patient, caregiver, and counselor utterances segmented and annotated with the MYSCOPE behavior codes, illustrated in Table~\ref{tab:codebook}.

\begin{small}
\begin{longtable}{p{1.3cm}p{2cm}p{5cm}p{4.8cm}}
\caption{MYSCOPE codebook} 
\label{tab:codebook} \\
\hline\noalign{\smallskip}
Annotation & Behavior & Description & Example \\ 
\noalign{\smallskip}\hline\noalign{\smallskip}
\endfirsthead
\multicolumn{4}{@{}l}{\textbf{Table\ref{tab:codebook}} (continued)} \\ 
\noalign{\smallskip}\hline\noalign{\smallskip}
Annotation & Behavior & Description & Example \\
\noalign{\smallskip}\hline\noalign{\smallskip}
\endhead

\rowcolor{lightgraycol}
\noalign{\smallskip}
\multicolumn{4}{l}{\textbf{Counselor}} \\
\noalign{\smallskip}
AF & Affirmation & Positive or complimentary statements that express appreciation, confidence, or reinforce the patient's strengths or efforts. & ``You guys, as a family, are already doing a lot of really positive things.'' \\
AR & Action reflection & Statements that reflect back the patient's statement(s) while at the same time embedding a solution to a barrier or an action plan. & ``If you decide to follow a meal plan, it has to include occasional dessert.'' \\
EA & Emphasize autonomy & Statements that directly acknowledge, honor, or emphasize the patient's freedom of choice, autonomy, personal responsibility, and so forth. & ``Okay. Well, it's your plan, so whatever works best for you. If you feel like you want one that's written down that you can refer back to, then let's write it and if not then that's fine.''\\
GINFON & General information negative & The counselor gives advice, makes a suggestion, offers a solution/possible action, gives feedback, or offers educational information in a non-patient-centered manner. & ``Healthy weight loss is about one to two pounds a week and once we get you set up and actually into the program you can look for that to happen for about one to two pounds a week to get you on that goal.''\\
GINFOP & General information positive & The counselor gives advice, makes a suggestion, offers a solution/possible action, gives feedback, expresses a concern, or offers educational information in a patient-centered manner (i.e., asking permission, using the third person, giving the opportunity to reject the information, and offering a menu of options). & ``Okay.  Alright so I just wanted to tell you that I will be asking you a lot of questions.  It may get redundant.  So, if at any point in time you need a break or I'm asking too much go ahead and let me know.''\\
QEB & Question to elicit barriers & Questions designed to initiate a discussion of barriers to change. & ``Alright.  So, are these ideas you feel you can put in place for this week?''\\
QECHTP & Question to elicit change talk positive & Questions that ask about the patient's desire, ability, reasons, or need for change or that reference past action toward behavior change or barriers to change. & ``Okay.  And tell me a little bit more about that.  Like what do you foresee your goal in this program?  Like what do you want to happen out of this program?''\\
QECMLP & Question to elicit commitment language positive & Questions that ask about current or future action toward behavior change or reference barriers to change. & ``Okay.  Is there something else that you could do eat maybe instead of a Pop-Tart that's a little bit healthier?''\\
QEF & Question to elicit feedback & Statements that solicit the patient's thoughts, ideas, or feelings about a specific recommendation or piece of information. & ``So, do you have any questions about that?''\\
QEST & Question to elicit sustain talk & Questions designed to elicit negative change talk or negative commitment language. & ``And about how many hours would you say you watched TV for today?  Or played video games or YouTube?''\\
QO & Question other & Open- or close-ended questions unrelated to the target behavior. & ``Yup. What do you think might get in your way of being able to provide that kind of support for [your daughter]?''\\
RCHTP & Reflect change talk positive & A reflective listening statement that captures and returns a patient's statement or behavior from the current or a previous session that describes the patient's desire, ability, reasons, or need for change or past action or barriers to change. & ``So, it sounds like you just want to be healthy and you want to be stylish. You want to fit into some different types of clothes.''\\
RCMLP & Reflect commitment language positive & A reflective listening statement that captures and returns a patient's statement or behavior from the current or a previous session that describes current or future action or references barriers to changing with the goal of problem-solving. & ``You are ready to start this plan today.''\\
RO & Reflect other & A reflective listening statement that captures and returns a patient's utterance or behavior from the current or previous session that is unrelated to the target behavior. & ``You are having a hard time at work.''\\
RST & Reflect sustain talk & These statements reflect negative change talk or negative commitment language made by the patient. & ``Oh okay.  So, money influences your environment.''\\
SO & Statement other & An utterance eliciting feedback, offering support, self-disclosure, or of some other form besides a strategy or reflection & ``You're being pulled in a million directions''\\
SPT & Support & These are generally supportive, understanding comments. They have the quality of commenting on a situation, or of agreeing or siding with the patient in a genuine way. & ``I'm concerned about you, given all these difficulties you've been having.''\\
SS & Structure session & A communication strategy that suggests an attempt to describe what will happen in the session or to refocus a meandering conversation back to the target behaviors & ``Maybe when the three of us come together in a few minutes, that's something that we could just clarify with her, like is that really what she wants.''\\
SUM & Summary & A reflective listening statement that captures and returns at least 2 different ideas from a patient's utterance or behavior from the current session & ``You have thought a lot about this.  Sometimes it feels like losing weight is just too hard.  Yet you have lots of reasons to lose weight.  If you could find a program you could stick to, a program that would not have too many changes at once, you would consider it.''\\

\rowcolor{lightgraycol}
\noalign{\smallskip}
\multicolumn{4}{l}{\textbf{Patient}} \\
\noalign{\smallskip}
CT & Change Talk & Statements that express the patient's desire, ability, reasons, need for, or commitment to (intentions, plans, and action steps) changing their behavior & ``I will try to buy less junk food.''\\
ST & Sustain Talk & Statements that express the patient's desire, ability, reasons, need for, or commitment to (intentions, plans, and action steps) to maintain the status quo or not change their behavior  & ``I didn't get to the gym this week.''\\
HUPO	 & High uptake other & An utterance that develops the topic of the conversation but is about non-target behaviors or interruptions & ``Yeah because the mentor comes and they take off and they go someplace for a little while.''\\
HUPW & High uptake weight & A turn that does develop the topic of the conversation. High Uptake statements include: weight related statements about actions of commitment, change talk, and ambivalence that occurred in the past, patient questions to the counselor, and session interruptions by persons who are not an active part of the treatment session. & ``Support is always good.  You know that's a key factor.  Mm-hmm.''\\
LUP & Low uptake  & An utterance that does not develop the topic of conversation but still allows it to continue & ``Mm-hmm.  Right.''\\
\hline
\end{longtable}
\end{small}

\subsection{Data preprocessing}
\label{subsec:datapreprocessing}
Utterances in MI session transcripts were segmented into successful and unsuccessful communication sequences. For each MI transcript, the stream of behavior codes from beginning to end was analyzed. Successful sequences were defined as those that resulted in a patient change talk or commitment language statement. Unsuccessful sequences were similarly created for sequences resulting in sustain talk. A total of 1,360 sequences were generated using this approach. The majority of the sequences (n=1,102) were successful, which is expected for a treatment-seeking population, in which the initial motivation for behavior change is typically high. Successful sequences had an average length of 5.28 utterances, while unsuccessful sequences had on average 5.29 utterances.  

\subsection{Data Modeling}
\label{subsec:dataModeling}
\subsubsection{Hidden Markov Model}
\label{subsubsec:hiddenMarkovModel}
We applied the Hidden Markov Model (HMM)\footnote{we used the implementation in the hmmlearn package publicly available at http://hmmlearn.readthedocs.io/} to identify clusters of behavior codes corresponding to successful and unsuccessful communication sequences and to describe the relationships (transitions) between these clusters. Given a set of behavior code sequences, the posterior inference of HMM parameters involves the deduction of a temporal sequence of hidden states that best explains observations in each sequence. The rows in the emission probability matrix correspond to the distribution of observation symbols (i.e., the MYSCOPE behaviors displayed) for each hidden state and the transition probability matrix describes the transitions between the hidden states. Training an HMM with a given number of hidden states ($N$) involves estimating the following parameters using the Baum-Welch algorithm:

\begin{itemize}
\item $M$ is the number of distinct observations symbols per state, i.e. the discrete codebook size (Table~\ref{tab:codebook})
\item $T$ is an $NXN$ state transition probability matrix, in which $t_{ij}$ is the probability of HMM transitioning from state $i$ to state $j$  
\item $E$ is an $NXM$ emission probability matrix, in which $e_{jk}$ is the probability of observing symbol $k$, when HMM is in state $j$ 
\item $p$ is the initial state distribution vector where $\pi_i$ is the probability of the first HMM state
\end{itemize}

We trained two HMM models, one using all successful sequences and the other one using all unsuccessful sequences. Each model was trained with the objective of maximizing the log-likelihood of all observations in the corresponding set of sequences. The optimal number of hidden states was determined by estimating the Bayesian information criterion (BIC) of HMM models with a different number of hidden states and selecting the model with the smallest value of BIC, which takes into account both log-likelihood and a penalty term for the number of parameters in the model to avoid overfitting. Experiments with a different number of hidden states in HMMs estimated on successful and unsuccessful sequences indicated that 5 hidden states were optimal for successful sequences and 2 hidden states were optimal for unsuccessful sequences (Figure~\ref{fig:bic}). 

\begin{figure*}
\centering
\includegraphics[width=1.0\textwidth]{figures/bic-vs-hidden-states.eps}
\caption{Bayesian information criterion (BIC) of HMM models of successful (left) and unsuccessful (right) interviews by varying the number of hidden states}
\label{fig:bic}
\end{figure*}

\subsubsection{Frequent Pattern Mining}
\label{subsubsec:frequentPatternMining}
We applied frequent pattern mining to identify frequently occurring patterns of temporally ordered patient-counselor behavior codes in successful and unsuccessful communication sequences. Behavior codes in these patterns may be separated by one or more other codes. For this purpose, we utilized FPClose~\cite{grahne2005fast}, an efficient state-of-the-art close frequent pattern mining algorithm implemented in SPMF~\cite{fournier2014spmf, fournier2016spmf}, to identify frequent patterns of patient-counselor communication behaviors in successful and unsuccessful MI communication sequences. SPMF is an open-source library providing more than 150 data mining algorithms. Popular non-close frequent pattern mining algorithms include Apriori~\cite{agrawal1994fast} and FP-Growth~\cite{han2000mining}. A \textit{frequent pattern} is defined as a pattern of temporally ordered observations, which appears in a given set of sequences more often than a user-specified threshold called the minimum \textit{support count}. For example, \{A\}, \{C\}, \{D\}, and \{C, D\} are frequent patterns in the example set of sequences in Figure~\ref{fig:fpm}, since these patterns appear at least 2 times, which is the minimum support count in this example. In this work, we identified and analyzed \textit{closed frequent patterns} among all sequences of behavior codes in successful and unsuccessful communication sequences. A \textit{frequent pattern is closed} if none of its supersets have the same support count~\cite{pasquier1999discovering}, where a set X is a superset of another set Y, if X contains all the elements of the set Y. For example, the itemsets \{A\}, \{C\}, \{D\}, and \{C, D\} in Figure~\ref{fig:fpm} are not closed frequent patterns, since their supersets \{A, B\}, \{B, C\}, \{B, D\}, and \{B, C, D\} have the same support count. Therefore, \{B\}, \{A, B\}, \{A, D\}, \{B, C\}, \{B, D\}, and \{B, C, D\} are closed frequent patterns, since none of their supersets have the same support count. On the other hand, itemsets \{A, C\}, \{A, B, C\}, \{A, B, D\}, \{A, C, D\} and \{A, B, C, D\} have support counts of 1, 0, 1, 0, and 1, respectively, which is less than the minimum support count, and thus are identified as non-frequent itemsets. Since the threshold for minimum support count depends on a task and is typically determined by the domain expert, we followed some prior works~\cite{moradi2017quantifying, liu1999mining} and set the minimum support count as 10\% of the total number of all communication sequences, which is 110 for successful and 25 for unsuccessful communication sequences. For each pattern, the statistical significance of difference between pattern occurrence in successful and unsuccessful communications was reported by computing p-value using Pearson's chi-square test.  

\begin{figure*}
\centering
\includegraphics[width=0.8\textwidth]{figures/fpm.eps}
\caption{A sample collection of sequences and different types of frequent patterns obtained by a frequent pattern mining method with the minimum support of 2}
\label{fig:fpm}
\end{figure*}

\begin{sidewaystable}
\vspace{43\baselineskip}

\caption{Hidden Markov Model Emission Matrices}
\label{tab:emission}
\begin{tabularx}{\textwidth}{lXXXp{0.4cm}XXXXXXXXXXXXXXXXXXX}
\hline\noalign{\smallskip}
State & AF & AR & EA & GIN-FON & GIN-FOP & QEB & QEC-HTP & QEC-MLP & QEF & QE-ST & QO & RC-HTP & RC-MLP & RO & RST & SO & SPT & SS & SUM & HU-PO & HU-PW & LUP \\
\noalign{\smallskip}\hline\noalign{\smallskip}
\rowcolor{lightgraycol}
\multicolumn{23}{l}{\textbf{Successful  Sequences}} \\

High Motivation & 12\% & 5\% & 4\% & 0\% & 3\% & 0\% & 0\% & 1\% & 0\% & 0\% & 1\% & 29\% & 17\% & 1\% & 7\% & 2\% & 5\% & 6\% & 6\% & 0\% & 0\% & 0\% \\

High Receptivity & 15\% & 2\% & 5\% & 0\% & 18\% & 1\% & 16\% & 5\% & 3\% & 1\% & 0\% & 1\% & 0\% & 6\% & 5\% & 3\% & 3\% & 7\% & 4\% & 4\% & 1\% & 1\% \\

Moderate Receptivity & 2\% & 1\% & 14\% & 0\% & 8\% & 1\% & 20\% & 9\% & 5\% & 1\% & 2\% & 2\% & 0\% & 1\% & 0\% & 1\% & 0\% & 5\% & 4\% & 5\% & 2\% & 16\% \\

Low Receptivity & 4\% & 1\% & 17\% & 0\% & 3\% & 1\% & 11\% & 0\% & 2\% & 0\% & 0\% & 5\% & 3\% & 3\% & 3\% & 0\% & 1\% & 7\% & 1\% & 6\% & 0\% & 28\% \\

Active Feedback & 1\% & 1\% & 3\% & 0\% & 7\% & 1\% & 0\% & 9\% & 3\% & 0\% & 1\% & 0\% & 0\% & 0\% & 3\% & 1\% & 0\% & 1\% & 1\% & 10\% & 12\% & 47\% \\

\rowcolor{lightgraycol}
\multicolumn{23}{l}{\textbf{Unsuccessful  Sequences}} \\

Ambivalent & 13\% & 5\% & 4\% & 1\% & 6\% & 0\% & 1\% & 5\% & 0\% & 2\% & 2\% & 20\% & 7\% & 2\% & 12\% & 3\% & 4\% & 5\% & 6\% & 0\% & 2\% & 0\% \\

Avoidant  & 3\% & 1\% & 6\% & 0\% & 11\% & 7\% & 8\% & 1\% & 3\% & 2\% & 2\% & 1\% & 1\% & 5\% & 4\% & 0\% & 1\% & 2\% & 0\% & 11\% & 4\% & 29\% \\

\noalign{\smallskip}\hline
\end{tabularx}

\vspace{2\baselineskip}

\caption{Hidden Markov Model Transition Matrices}
\label{tab:transition}  
\begin{tabularx}{\textwidth}{XXXXXX}
\hline\noalign{\smallskip}
State & High Motivation & High Receptivity & Moderate Receptivity & Low Receptivity & Active Feedback \\
\noalign{\smallskip}\hline\noalign{\smallskip}
\rowcolor{lightgraycol}
\multicolumn{6}{l}{\textbf{Successful  Sequences}} \\
High Motivation & 2\% & 9\% & 24\% & 24\% & 41\% \\
High Receptivity & 7\% & 9\% & 20\% & 25\% & 39\% \\
Moderate Receptivity  & 8\% & 19\% & 24\% & 23\% & 27\% \\
Low Receptivity  & 11\% & 26\% & 28\% & 18\% & 17\% \\
Active Feedback  & 25\% & 34\% & 20\% & 15\% & 6\% \\
\rowcolor{lightgraycol}
\multicolumn{6}{l}{\textbf{Unsuccessful  Sequences}} \\
& Ambivalent & Avoidant & & & \\
Ambivalent & 16\% & 84\% & & & \\
Avoidant & 39\% & 61\% & & & \\
\noalign{\smallskip}\hline
\end{tabularx}
\end{sidewaystable}


\section{Results}
\label{sec:results}
The transition and emission probability matrices of HMM model are reported in Tables~\ref{tab:emission} and \ref{tab:transition}. The three behaviors with the highest frequency, representing 45-69\% of each state's emission probability mass, were used to interpret the emission matrix and label the hidden states. Most (84\%) successful sequences began in a state characterized as \textit{``high motivation''} as evidenced by a greater proportion of three counselor behaviors: reflections of change talk (29\%), reflections of commitment language (17\%), and affirmations (12\%). Successful sequences began in a state of \textit{``high receptivity''} 11\% of the time. \textit{``High receptivity''} sequences were characterized by nearly equal proportions of information offered using patient-centered strategies (18\%), questions to elicit change talk (16\%), and affirmations (15\%). Few successful sequences began in states of \textit{``moderate receptivity''} and \textit{``low receptivity''} (2\% and 3\% of the time, respectively). These two states were characterized by different proportions of the same behaviors. \textit{``Moderate receptivity''} sequences were distinguished from \textit{``low receptivity''} sequences by a greater proportion of counselor questions to elicit change talk (20\% versus 11\%) and a lower proportion of patient low uptake statements (16\% versus 28\%); counselor statements emphasizing the patient's autonomy were about the same (14\% versus 17\%). No (0\%) successful sequence began in the \textit{``active feedback''} state, which was characterized by three patient behaviors, low uptake (47\%), weight-related high uptake (12\%), and other-related high uptake (10\%). Successful sequences transitioned from \textit{``high motivation''} to \textit{``active feedback''} most often (41\%). \textit{``Active feedback''}, in turn, most frequently transitioned to \textit{``high receptivity''} (39\%). The \textit{``moderate receptivity''} state transitioned to most often to \textit{``active feedback''} (27\%) and automatically transitioned back to \textit{``moderate receptivity''} (24\%) or to \textit{``low receptivity''} (23\%) with similar frequency. The full transition matrix is presented in Table~\ref{tab:transition}.

In contrast, the majority of unsuccessful sequences (98\%) began in a state of \textit{``ambivalence''} as indicated by the greater proportion of counselor reflections of both change talk (20\%) and sustain talk (12\%) as well as affirmations (13\%). About 2\% of the time unsuccessful sequences started in a state of \textit{``avoidance''}. Higher rates of patient low uptake (29\%) and other-related high uptake (11\%) statements, and counselor patient-centered information (18\%) distinguished \textit{``avoidant''} sequences. Both \textit{``ambivalent''} (84\%) and \textit{``avoidant''} (61\%) states most frequently transitioned to the \textit{``avoidant''} state.

Results from frequent pattern mining analysis is presented in Table~\ref{tab:patterns}. Reflections of change talk were the most frequent counselor communication behavior in both successful (36.1\%) and unsuccessful sequences (33.7\%). Successful sequences were distinguished from unsuccessful sequences by a higher frequency of counselor questions phrased to elicit change talk (30.8\% versus 17.4\%, p= $<$0.001), statements emphasizing the patient's decision-making autonomy (28.5\% versus 18.6\%, p=0.001), questions phrased to elicit commitment language (18.1\% versus 11.6\%, p=0.011), and reflections of commitment language (20.7\% versus 15.1\%, p=0.042). In contrast, unsuccessful sequences were characterized by greater frequency of questions to elicit perceived barriers (14.7\% versus 0\%, p= $<$0.001), reflections of sustain talk (27.1\% versus 15.8\%, p= $<$0.001), providing information (28.7\% versus 22.1\%, p=0.025) and other reflections (11.6\% versus 0\%, p= $<$0.001). In 14.0\% of the successful sequences, reflections of change talk were paired with a question phrased to elicit change talk; this pattern did not appear in $>$10\% of the unsuccessful sequences. In contrast, in 10.5\% of the unsuccessful sequences, reflections of change talk were paired with information; this pattern did not appear in $>$10\% of the successful sequences.

\begin{table}
\begin{threeparttable}
\caption{Frequent communication patterns in successful and unsuccessful patient-counselor communication sequences}
\label{tab:patterns}   
\begin{tabularx}{\textwidth}{p{3cm}XX@{\extracolsep{4pt}}p{3cm}XX}
\hline\noalign{\smallskip}
\multicolumn{3}{c}{Successful} & \multicolumn{3}{c}{Unsuccessful} \\
\noalign{\smallskip}\cline{1-3} \cline{4-6}\noalign{\smallskip}
LUP & 573 & 52.0\% & LUP & 118 & 45.7\%  \\
RCHTP & 398 & 36.1\% & RCHTP & 87 & 33.7\% \\ 
\multicolumn{1}{r}{LUP, RCHTP} & 224 & 20.3\% & \multicolumn{1}{r}{LUP, RCHTP} & 45 & 17.4\% \\
QECHTP & 339 & 30.8\% & GINFOP & 74 & 28.7\% \\
\multicolumn{1}{r}{LUP, QECHTP} & 184 & 16.7\% & \multicolumn{1}{r}{LUP, GINFOP} & 44 & 17.1\% \\
AF & 314 & 28.5\% & RST & 70 & 27.1\% \\
\multicolumn{1}{r}{LUP, AF} & 166 & 15.1\% & \multicolumn{1}{r}{LUP, RST} & 30 & 11.6\% \\
EA & 314 & 28.5\% & AF & 68 & 26.4\% \\
\multicolumn{1}{r}{LUP, EA} & 188 & 17.1\% & EA & 48 & 18.6\% \\
GINFOP & 244 & 22.1\% & \multicolumn{1}{r}{LUP, EA} & 28 & 10.9\% \\
\multicolumn{1}{r}{LUP, GINFOP} & 143 & 13.0\% & QECHTP & 45 & 17.4\% \\
RCMLP & 228 & 20.7\% & RCMLP & 39 & 15.1\% \\
\multicolumn{1}{r}{LUP, RCMLP} & 121 & 11.0\% & QEB & 38 & 14.7\% \\
QECMLP & 200 & 18.1\% & RO & 30 & 11.6\% \\
RST & 174 & 15.8\% & QECMLP & 30 & 11.6\% \\
\multicolumn{1}{r}{LUP, RST} & 114 & 10.3\% & SUM & 29 & 11.2\% \\
RCHTP, QECHTP & 154 & 14.0\% & SS & 28 & 10.9\% \\
SUM & 138 & 12.5\% & RCHTP, GINFOP & 27 & 10.5\% \\
LUP, SS & 112 & 10.2\% & HUPO & 47 & 18.2\% \\
HUPO & 173 & 15.7\% &  &  &  \\ 
\noalign{\smallskip}\hline
\end{tabularx}
\begin{tablenotes}
      \small
      \item \textit{Note:} Patterns that are aligned to the right are included in the immediately preceding pattern count. In these patterns, a counselor behavior was paired with a patient low uptake/facilitative comment, which is a marker of patient attention to the conversation and feedback suggesting the line of discussion may continue.
\end{tablenotes}
\end{threeparttable}
\end{table}

\section{Discussion}
\label{sec:discussion}
This study applied HMM and frequent pattern mining to test the fundamental hypothesis guiding Motivational Interviewing, which posits that counselors use of ``MI-consistent'' communication strategies (MICO) will lead to patient change talk~\cite{miller2009toward}. Previous studies have empirically linked counselors' use of MICO to higher rates of patient change talk in first-order Markov Chain models~\cite{moyers2006therapist, moyers2009session, gaume2010counselor}. The present study leveraged data mining methods to provide an even stronger evidence for MI's fundamental hypothesis by considering longer-term dependencies in the data. Unlike simple first-order Markov chain models, frequent pattern mining considers behavioral antecedents beyond the counselor behavior immediately preceding a patient change talk statement, while HMM identifies groups of communication behaviors occurring in successful and unsuccessful communication sequences. The ability of HMM and frequent pattern mining to identify critical patterns in patient-counselor communication sequences advances research in the field of Motivational Interviewing, which has previously relied upon simple Markov chain models~\cite{moyers2006therapist, moyers2009session, gaume2008counsellor, gaume2010counselor, glynn2014change, carcone2013provider, jacques2016building}.

In both analyses, MICO communication strategies were characteristic of successful sequences (i.e., those resulting in a change talk statement). In HMM, the majority of successful sequences began in the \textit{``high motivation''} state, when counselors frequently use reflections of change talk or commitment language as well as affirmations. Other high frequency counselor behaviors observed in successful sequences included statements emphasizing patients' decision-making autonomy, questions phrased to elicit change talk, and the provision of information using patient-centered strategies. The frequent pattern mining results were similar. Reflections of change talk was the most frequent counselor communication strategy in successful sequences, followed by open questions phrased to elicit change talk, affirmations, statements emphasizing the patient's decision-making autonomy, and sensitively provided information. Previous studies of MI behavior code sequences, which relied on first-order Markov chain models to analyze communication sequences, have linked patients' expression of change talk to counselor reflections of change talk,~\cite{moyers2009session, gaume2010counselor, glynn2014change, carcone2013provider, jacques2016building} open questions phrased to elicit change talk,~\cite{moyers2009session, carcone2013provider, jacques2016building}, and statements emphasizing the patient's decision-making autonomy~\cite{carcone2013provider, jacques2016building}. However, these studies did not find a link between change talk and counselors' use of affirmations or the provision of information, when examined independently of the MICO index. Thus, the present study is the first to provide empirical evidence for these causal linkages. One reason for this unique finding may be the treatment context, adolescent patients engaged in a voluntary weight loss trial. Adaptations of MI for the health care setting suggest that asking questions, demonstrating active listening through reflections, and the provision of information are critical communication skills for encouraging health-related behavior change~\cite{douaihy2015motivational}. Thus, providing information in a patient-centered manner in the context of health care treatment may be necessary to ensure patients have the requisite knowledge of their health care problem and its treatment. 

The analysis of unsuccessful sequences, i.e., those resulting in a patient sustain talk statement, was typified by a combination of MICO and MI-inconsistent communication strategies (MIIN). Specifically, the majority of unsuccessful sequences in the HMM analysis began in a state of \textit{``ambivalence''} which was characterized by large proportions of counselor reflections of both change talk and sustain talk. Similarly, in the frequent pattern mining analysis of unsuccessful sequences, reflections of change talk and sustain talk were two of the three most frequent counselor behaviors observed. These results are consistent with those of Gaume et al.~\cite{gaume2010counselor} who found both MICO and MIIN were linked to the elicitation of sustain talk in a sample of at-risk young adult drinkers enlisted into the military. Specifically, counselors' use of simple and complex reflections and ``other MICO'' behaviors (an index of affirmations, statements emphasizing patient control, reframing, and support) were empirically linked to the elicitation of sustain talk; neither open or closed questions were related to the elicitation of sustain talk. Carcone et al.~\cite{carcone2013provider} found counselors' questions and reflections specifically phrased to elicit patient sustain talk were the counselor behaviors most likely to elicit sustain talk among adolescents engaged in a weight loss trial. In contrast, Moyers et al.~\cite{moyers2009session} found questions about the positive and negative aspects of the target behavior and reflections of sustain talk were empirically linked to the elicitation of sustain talk but MIIN was not. These variable findings suggest a need to tailor the communication strategies MI counselors use to the treatment context. 

This study is part of a line of research to develop machine-learning models to annotate (code) and analyze patient-counselor communication patterns. We have previously reported on the development of probabilistic generative models~\cite{kotov2014towards, kotov2015interpretable} and application of novel features for maximum margin and deep learning classifiers~\cite{hasan2016study} with the goal of automated annotation of MI session transcripts. Experiments applying the annotation model to novel datasets are underway to assess the generalizability of the model to more diverse types of clinical encounters (e.g, email coaching to increase fruit and vegetable intake, HIV clinical care visits~\cite{carcone2018using}). We also developed and evaluated probabilistic and deep learning methods for the task of predicting success of motivational interviews at any point during the interview~\cite{hasan2018predicting}. In this study, we present the next phase of this research, the sequential analysis of patient-counselor communication data to identify the counselor communication strategies linked to the elicitation of change talk and sustain talk. Next steps include examining the performance of these models in diverse data sets representing different populations and behavioral problems. We are also experimenting with machine learning methods to segment (parse) the stream of communications in healthy eating promotion intervention delivered by email into semantically coherent chunks (phrases, sentences or paragraphs), to which the annotation model can then assign a behavior code. Together, these models form the basis of a complete system to automatically code and analyze patient-counselor interactions. An automated system for behavioral coding and analysis could substantially accelerate the pace of research on the causal mechanisms of Motivational Interviewing and inform both the theory and clinical practice by providing clinicians with information about how to best tailor their communication strategies to different patient populations. 

This study is limited by the use of one dataset composed of 37 Motivational Interviewing transcripts of counseling sessions with African American adolescents in weight loss treatment. Thus, there is a need to replicate these findings with larger and more diverse data samples as the findings may not be representative of communication patterns in other contexts employing the Motivational Interviewing framework. In fact, when interpreted in light of the published literature, the results obtained in these experiments suggest that communication patterns are likely to vary given the treatment context. There are, however, consistencies with previous Motivational Interviewing process studies providing support for the validity of our findings and suggesting some counselor communication strategies may cut across treatment contexts. Next steps for this work include enhancing the performance and utility of machine learning models for sequential analysis by combining transcript annotation with sequential analysis. Another limitation of this work is the fact that successful and unsuccessful sequences were analyzed independently. One implication of this approach is that the utility of a counselor behavior, such as the provision of information, to shift an interaction destined for unsuccess to success, cannot be determined from these analyses.

\section{Conclusion}
\label{sec:conclusion}
These results add to the growing evidence base examining the mechanisms of effect in Motivational Interviewing using modeling approaches that overcome critical shortcomings of previous methods. While counselors' use of ``MI-consistent'' communication behaviors has been previously linked to higher rates of change talk in correlational studies~\cite{moyers2006therapist, catley2006adherence, thrasher2006motivational, mccambridge2011fidelity} and simple Markov chain models~\cite{moyers2006therapist, moyers2009session, gaume2010counselor}, the use of HMM and frequent pattern mining analyses improves upon these approaches by considering long-term dependencies in the data. The results of this work suggest a more complex pattern between counselor communication behaviors and patient talk that varies depending on the context in which Motivational Interviewing is being used.  

\section{Conflict of Interest}
\label{sec:conflictofInterest}
On behalf of all authors, the corresponding author states that there is no conflict of interest.

\begin{acknowledgements}
This study was supported by a grant from the National Institutes of Health, NIDDK R21DK108071, Carcone and Kotov, MPIs. We would like to thank the student assistants in the Department of Family Medicine and Public Health Sciences at Wayne State University School of Medicine for their help in developing the training dataset. The authors would like to thank Lisa Todd, JD, MA for her thoughtful feedback and clinical expertise in the interpretation of these data.
\end{acknowledgements}

\bibliographystyle{natbib}       % JHIR format
\bibliography{references}   
\end{document}
